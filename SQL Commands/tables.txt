USE hoteldata;

CREATE TABLE Account (
    Name VARCHAR(15) NOT NULL,
    Email VARCHAR(60) NOT NULL PRIMARY KEY,
    Password VARCHAR(15) NOT NULL,
    UserType varchar(15) NOT NULL
);

CREATE TABLE Preset_Query (
    QueryName VARCHAR(20) NOT NULL PRIMARY KEY,
    PresetText TEXT NOT NULL
);

CREATE TABLE Customer (
    SSN CHAR(11) NOT NULL PRIMARY KEY,
    Name VARCHAR(15) NOT NULL,
    Surname VARCHAR(15) NOT NULL,
    Phone_number CHAR(15) NOT NULL,
    Email VARCHAR(60) DEFAULT NULL
);

CREATE TABLE Room (
    Room_type VARCHAR(20) NOT NULL,
    Room_number CHAR(4) NOT NULL PRIMARY KEY,
    Capacity CHAR NOT NULL,
    Occupied TINYINT NOT NULL DEFAULT 1
);

CREATE TABLE Employee (
    SSN CHAR(11) NOT NULL PRIMARY KEY,
    Name VARCHAR(15) NOT NULL,
    Surname VARCHAR(15) NOT NULL,
    Phone_number CHAR(15) NOT NULL UNIQUE,
    Duty VARCHAR(15) DEFAULT NULL,
    Workload CHAR(3) DEFAULT NULL,
    Age CHAR(3) NOT NULL,
    CHECK (CAST(Age AS UNSIGNED) > 18)
);

CREATE TABLE DailyRoomPayment (
    RoomType VARCHAR(20) NOT NULL PRIMARY KEY,
    Amount CHAR(6) NOT NULL
);

CREATE TABLE Booking (
    BookingId CHAR(11) NOT NULL PRIMARY KEY,
    BookingDate DATE NOT NULL,
    ExitDate DATE DEFAULT NULL,
    NumberOfGuests CHAR(2) NOT NULL,
    RoomNo CHAR(4) NOT NULL,
    Cssn CHAR(11) NOT NULL,
    FOREIGN KEY (RoomNo) REFERENCES Room(Room_number) ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY (Cssn) REFERENCES Customer(SSN) ON DELETE CASCADE ON UPDATE CASCADE
);

CREATE TABLE Salary (
    SalaryID CHAR(5) NOT NULL PRIMARY KEY,
    SSN_No CHAR(11) NOT NULL UNIQUE,
    Amount DECIMAL(7) NOT NULL,
    PayDay DATE NOT NULL,
    Currency VARCHAR(11) NOT NULL,
    CHECK (Amount > 0),
    FOREIGN KEY (SSN_No) REFERENCES Employee(SSN) ON DELETE CASCADE ON UPDATE CASCADE
);

CREATE TABLE Pet (
    PetName VARCHAR(20) NOT NULL,
    Specie VARCHAR(20) NOT NULL,
    Cssn CHAR(11) NOT NULL,
    PRIMARY KEY (Cssn, PetName),
    FOREIGN KEY (Cssn) REFERENCES Customer(SSN) ON DELETE CASCADE ON UPDATE CASCADE
);

CREATE TABLE Child (
    ChildName VARCHAR(20) NOT NULL,
    Cssn CHAR(11) NOT NULL,
    BirthYear CHAR(4) NOT NULL,
    PRIMARY KEY (Cssn, ChildName),
    FOREIGN KEY (Cssn) REFERENCES Customer(SSN) ON DELETE CASCADE ON UPDATE CASCADE
);

CREATE TABLE WorkOn (
    Essn CHAR(11) NOT NULL,
    Rnumber CHAR(4) NOT NULL,
    PRIMARY KEY (Essn, Rnumber),
    FOREIGN KEY (Essn) REFERENCES Employee(SSN) ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY (Rnumber) REFERENCES Room(Room_number) ON DELETE CASCADE ON UPDATE CASCADE
);